<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
     
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css"> 
    <link rel="stylesheet" href="../../fonts/academicons-1.8.6/css/academicons.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
    <link rel="icon" type="image/png" sizes="32x32" href="../../img/logo.png"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="baidu-site-verification" content="code-HxM5pCr1nD" />
    
    
    
    
    
    
    <title>æŠ˜è…¾äº†ä¸€å¤©ï¼Œç»ˆäºæŠŠè¿™ä¸ª R åŒ…è£…ä¸Šäº† - æ²ˆç»´ç‡• | BioIT çˆ±å¥½è€…</title> 
    <meta property="og:title" content="æŠ˜è…¾äº†ä¸€å¤©ï¼Œç»ˆäºæŠŠè¿™ä¸ª R åŒ…è£…ä¸Šäº† - æ²ˆç»´ç‡• | BioIT çˆ±å¥½è€…">
    

    
      
    

    

    
  
    <link rel="stylesheet" href="https://blog.weiyan.cc/css/style.css"/>
    <link rel="stylesheet" href="https://blog.weiyan.cc/css/fonts.css"/>
    

<link rel="stylesheet" href="https://blog.weiyan.cc/css/template-styles.css" />
<link rel="stylesheet" href="https://blog.weiyan.cc/css/custom.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.3.1/build/styles/github.min.css">


  </head>

  
  <body class="tech">
    
    
    <header class="intro-and-nav" role="banner">
    <div>
      <div class="intro">
        <a class="logo" href="../../" aria-label="æ²ˆç»´ç‡• | BioIT çˆ±å¥½è€… home page">
          <img src="https://blog.weiyan.cc/img/logo.png" alt="">
        </a>
        <p class="library-desc">
          
            Bio &amp; IT çˆ±å¥½è€…
          
        </p>
      </div>
      <nav id="patterns-nav" class="patterns" role="navigation">
        <h2 class="vh">Main navigation</h2>
        <button id="menu-button" aria-expanded="false">
          
          ç›®å½•
        </button>
        
        <ul id="patterns-list">
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../" >
              
              é¦–é¡µ
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../about/" >
              
              å…³äº
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../tech/" >
              
              æŠ€æœ¯
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../note/" >
              
              éšç¬”
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../portfolio/" >
              
              ä½œå“
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../archive/" >
              
              å½’æ¡£
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../feedback/" >
              
              ç•™è¨€
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../tags/" >
              
              æ ‡ç­¾
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="https://www.yuque.com/shenweiyan" >
              
              è¯­é›€
            </a>
          </li>
          
          

<li class="pattern">&nbsp;&nbsp;</li>



<li class="pattern"><a href="https://github.com/shenweiyan/WebSiteSRC/edit/main/content/tech/2023-06-14-r-sf.md" target="_blank">ç¼–è¾‘</a></li>


<li class="pattern"><a href="../../tech/index.xml" type="application/rss+xml" title="RSS feed">è®¢é˜…</a></li>

<li class="pattern"><a href="../../license/" title="License">ç‰ˆæƒ</a></li>


        </ul>
      </nav>
    </div>
    </header>

    <article class="main">
      <header class="title">
        

<h1>æŠ˜è…¾äº†ä¸€å¤©ï¼Œç»ˆäºæŠŠè¿™ä¸ª R åŒ…è£…ä¸Šäº†</h1>



<h4>æ²ˆç»´ç‡• &middot 
2023-06-14</h4> 


   
  


      </header>


  

  <blockquote>
<p>ğŸ“¢ æœ¬æ–‡ç« åŒæ­¥è‡ªä½œè€…çš„<a href="https://www.yuque.com/shenweiyan/">è¯­é›€çŸ¥è¯†åº“</a>ï¼Œè¯·ç‚¹å‡»<a href="https://www.yuque.com/shenweiyan/cookbook/r-sf">è¿™é‡Œ</a>é˜…è¯»åŸæ–‡ã€‚</p>
</blockquote>
<p>äº‹æƒ…èµ·å› äºåœ¨æ¨ç‰¹çœ‹åˆ°å…³äº<code>ggVennDiagram</code>è¿™ä¸ª R åŒ…æ•™ç¨‹çš„ä¸€æ¡æ¨æ–‡ï¼Œæƒ³ç€å»å¤ç°ä¸€ä¸‹ï¼Œäºæ˜¯å¼€å§‹å»å®‰è£…ï¼Œä¸æ–™å®‰è£…è¿‡ç¨‹ä¸­å‡ºç°äº†<code>sf</code>è¿™ä¸ªä¾èµ–åŒ…å§‹ç»ˆå®‰è£…ä¸æˆåŠŸçš„ä¸€å †é”™è¯¯ï¼Œäºæ˜¯æœ‰äº†è¿™ä¸€ç¯‡æ–‡ç« ï¼Œç‰¹æ­¤è®°å½•ä¸€ä¸‹ï¼Œä¹Ÿå¸Œæœ›ç»™é‡åˆ°ç±»ä¼¼é—®é¢˜çš„å°ä¼™ä¼´ä¸€ä¸ªå‚è€ƒã€‚</p>
<h1 id="ç¬¬ä¸€ä¸ªé”™è¯¯">ç¬¬ä¸€ä¸ªé”™è¯¯</h1>
<p>é¦–å…ˆè¯´æ˜ä¸€ä¸‹ï¼Œæˆ‘ç”¨çš„ R ç‰ˆæœ¬æ˜¯ 4.3.0ï¼ŒLinux ç³»ç»Ÿæ˜¯ Red Hat 6.5ã€‚</p>
<p>æœ€å¼€å§‹å®‰è£…<code>sf</code>è¿™ä¸ª R åŒ…é‡åˆ°çš„ç¬¬ä¸€ä¸ª error æ˜¯ GDAL/GEOS/Proj.4 ç‰ˆæœ¬ä¸ç¬¦åˆè¦æ±‚çš„æç¤ºã€‚

<div class="post-img-view">
<a data-fancybox="gallery" href="https://cos.shenlab.cn/yuque/0/2023/png/126032/1686708933109-481e3593-1893-4643-9341-d4373652256b.png">
<img src="https://cos.shenlab.cn/yuque/0/2023/png/126032/1686708933109-481e3593-1893-4643-9341-d4373652256b.png" alt="image.png"  />
</a>
</div>

</p>
<p>äºæ˜¯ï¼Œå¼€å§‹æ‰‹åŠ¨å»å®‰è£… GDAL/GEOS/Proj.4ï¼Œä¹‹æ‰€ä»¥é€‰æ‹©åŸºäºæ™®é€šç”¨æˆ·æ‰‹åŠ¨å»æºç ç¼–è¯‘å®‰è£…ï¼Œä¸»è¦ä¸€ä¸ªåŸå› æ˜¯ç³»ç»Ÿç‰ˆæœ¬å¤ªè€ï¼Œç¬¬äºŒå‡ºäºå®‰å…¨è€ƒè™‘é¿å… root å¸¦æ¥çš„ä¸€ç³»åˆ—éº»çƒ¦ã€‚</p>
<p>ä¸€ç•ªæŠ˜è…¾ï¼ŒæŠŠ <strong>gdal-2.2.3+geos-3.4.0+proj-4.9.1</strong> éƒ½è£…å¥½äº†ï¼Œè®¾ç½®å®Œ <strong>PATH+LD_LIBRARY_PATH</strong> åï¼Œå´æ‚²å‚¬çš„å‡ºç°ç±»ä¼¼è¿™ä¸ªçš„æŠ¥é”™ï¼š<a href="https://github.com/r-spatial/sf/issues/678">https://github.com/r-spatial/sf/issues/678</a> â€”â€” è¿™æ˜¯<code>sf</code>åŒ…çš„ä¸€ä¸ªé”™è¯¯ï¼</p>
<p>äºæ˜¯ï¼Œé—®é¢˜å˜æˆäº†å¦‚ä½•æˆåŠŸå»å®‰è£…<code>sf</code>åŒ…ï¼Œæˆ–è€…è¯´å¦‚ä½•è§£å†³<code>sf</code>çš„ <strong>proj_conf_test.c:4:28: error: expected &lsquo;)&rsquo; before &lsquo;const&rsquo;</strong> å®‰è£…é”™è¯¯ã€‚</p>
<h1 id="sf-åŒ…ä¾èµ–ä¸è§£å†³">sf åŒ…ä¾èµ–ä¸è§£å†³</h1>
<p>åœ¨<code>sf</code>åŒ…çš„ <a href="https://github.com/r-spatial/sf#linux">https://github.com/r-spatial/sf#linux</a> ä¸­æ˜ç¡®æåˆ°äº†è¿™ä¸ªåŒ…éœ€è¦ä¾èµ– GDAL/GEOS/Proj.4ï¼Œå…·ä½“ç‰ˆæœ¬è¦æ±‚å¦‚ä¸‹ã€‚</p>
<blockquote>
<p>ğŸ“¢ <strong>For Unix-alikes, GDAL (&gt;= 2.0.1), GEOS (&gt;= 3.4.0) and Proj.4 (&gt;= 4.8.0) are required.</strong></p>
</blockquote>
<p>åæ¥ç»è¿‡ä¸€ç•ªçš„æŠ˜è…¾å°è¯•ï¼Œæ‰å‘ç°ï¼š</p>
<ol>
<li><strong>gdal-2.2.3+geos-3.4.0+proj-4.9.1</strong> å‡ºç°ç±»ä¼¼<a href="https://github.com/r-spatial/sf/issues/678">è¿™ä¸ª</a>çš„æŠ¥é”™ â€”â€” <strong>proj_conf_test.c:4:28: error: expected &lsquo;)&rsquo; before &lsquo;const&rsquo;</strong>ï¼</li>
<li><strong>gdal-2.2.0+geos-3.4.0+proj-4.8.0</strong> çš„ç»„åˆå¯ä»¥è§£å†³ä»¥ä¸Šé‡åˆ°çš„é—®é¢˜ï¼</li>
<li><strong>æ‰‹åŠ¨æºç å®‰è£…çš„è¯ï¼ŒProj.4 è¦å…ˆäº GDAL å®‰è£…ï¼Œå› ä¸º GDAL å®‰è£…çš„æ—¶å€™éœ€è¦æŒ‡å®š Proj.4 è¿›è¡Œç¼–è¯‘ã€‚</strong></li>
</ol>
<h2 id="geos">GEOS</h2>
<ol>
<li>è¦æ±‚ GEOS version &gt;= 3.4.0ï¼›</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export PATH<span style="color:#f92672">=</span>/Bioinfo/Pipeline/SoftWare/gcc-4.8.5/bin:$PATH
wget https://download.osgeo.org/geos/geos-3.4.0.tar.bz2
tar xvjf geos-3.4.0.tar.bz2 -C ../build/
cd ../build/geos-3.4.0
./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/Pipeline/SoftWare/geos-3.4.0
make -j4 <span style="color:#f92672">&amp;&amp;</span> make install
</code></pre></div><h2 id="proj4">Proj.4</h2>
<ol>
<li>è¦æ±‚ Proj.4 (&gt;= 4.8.0) ï¼›</li>
<li>Proj.4 è¦å…ˆäº GDAL å®‰è£…ï¼</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export PATH<span style="color:#f92672">=</span>/Bioinfo/Pipeline/SoftWare/gcc-4.8.5/bin:$PATH
wget https://download.osgeo.org/proj/proj-4.8.0.tar.gz
tar zvxf proj-4.8.0.tar.gz -C ../build/
cd ../build/proj-4.8.0/
./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/Pipeline/SoftWare/proj-4.8.0
make -j4 <span style="color:#f92672">&amp;&amp;</span> make install
</code></pre></div><h2 id="gdal">GDAL</h2>
<ol>
<li>è¦æ±‚ GDAL version &gt;= 2.0.1ï¼›è®°ä½ä¸€å®šè¦åŠ  <strong>&ndash;with-static-proj4</strong> è¿›è¡Œç¼–è¯‘ï¼Œå¦åˆ™ <a href="https://github.com/r-spatial/sf/issues/678">https://github.com/r-spatial/sf/issues/678</a> è¿™ä¸ªé—®é¢˜æ²¡æ³•è§£å†³ï¼ï¼</li>
<li>å°è¯•äº†ä¸€ä¸‹ <strong>gdal-2.2.3+proj-4.9.1</strong> ç»„åˆï¼Œå¥½åƒæœ‰é—®é¢˜ï¼ˆ<strong>configure: error: GDALAllRegister not found in libgdal</strong>ï¼‰ï¼›</li>
</ol>
<p>
<div class="post-img-view">
<a data-fancybox="gallery" href="https://cos.shenlab.cn/yuque/0/2023/png/126032/1686707981701-d82448a7-95de-4571-b1ef-a5713e883cf6.png">
<img src="https://cos.shenlab.cn/yuque/0/2023/png/126032/1686707981701-d82448a7-95de-4571-b1ef-a5713e883cf6.png" alt="image.png"  />
</a>
</div>

</p>
<ol start="3">
<li>ä½†æ˜¯ GDAL-2.2.0+proj-4.8.0 æ˜¯å¯ä»¥çš„ï¼</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$enabledevtoolset4
wget http://download.osgeo.org/gdal/2.2.0/gdal-2.2.0.tar.gz
tar zvxf gdal-2.2.0.tar.gz -C ../build/
cd ../build/gdal-2.2.0
./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/Pipeline/SoftWare/gdal-2.2.0 --with-static-proj4<span style="color:#f92672">=</span>/Bioinfo/Pipeline/SoftWare/proj-4.8.0/
make -j4 <span style="color:#f92672">&amp;&amp;</span> make install
</code></pre></div><h2 id="æœ€ç»ˆå®‰è£…å‘½ä»¤">æœ€ç»ˆå®‰è£…å‘½ä»¤</h2>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export PATH<span style="color:#f92672">=</span>/Bioinfo/Pipeline/SoftWare/gdal-2.2.0/bin:/Bioinfo/Pipeline/SoftWare/geos-3.4.0/bin:/Bioinfo/Pipeline/SoftWare/proj-4.8.0/bin:$PATH
export LD_LIBRARY_PATH<span style="color:#f92672">=</span>/Bioinfo/Pipeline/SoftWare/gdal-2.2.0/lib:/Bioinfo/Pipeline/SoftWare/geos-3.4.0/lib:/Bioinfo/Pipeline/SoftWare/proj-4.8.0/lib:$LD_LIBRARY_PATH
</code></pre></div><p>å‡ºç° <strong>configure: error: libproj not found in standard or given locations.</strong> å¼‚å¸¸ï¼Œå‚è€ƒ <a href="https://github.com/r-spatial/sf/issues/1471">sf issues-1471</a> å¾—åˆ°è§£å†³ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># configure: error: libproj not found in standard or given locations.</span>
options<span style="color:#f92672">(</span><span style="color:#e6db74">&#34;repos&#34;</span><span style="color:#f92672">=</span>c<span style="color:#f92672">(</span>CRAN<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;https://mirrors.tuna.tsinghua.edu.cn/CRAN/&#34;</span><span style="color:#f92672">))</span>
install.packages<span style="color:#f92672">(</span><span style="color:#e6db74">&#39;sf&#39;</span>, configure.args<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;--with-gdal-config=/Bioinfo/Pipeline/SoftWare/gdal-2.2.0/bin/gdal-config --with-geos-config=/Bioinfo/Pipeline/SoftWare/geos-3.4.0/bin/geos-config --with-proj-include=/Bioinfo/Pipeline/SoftWare/proj-4.8.0/include --with-proj-lib=/Bioinfo/Pipeline/SoftWare/proj-4.8.0/lib&#39;</span>, configure.vars<span style="color:#f92672">=</span><span style="color:#e6db74">&#39;GDAL_DATA=/Bioinfo/Pipeline/SoftWare/gdal-2.2.0/share/gdal&#39;</span><span style="color:#f92672">)</span>
</code></pre></div><h1 id="ä½¿ç”¨è¯´æ˜">ä½¿ç”¨è¯´æ˜</h1>
<p>å®‰è£…å®Œ <code>sf</code> å’Œ <code>ggVennDiagram</code> åï¼Œå¦‚æœè¦ä½¿ç”¨è¿™ä¸¤ä¸ªåŒ…ï¼Œåˆ™éœ€è¦ï¼š</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export LD_LIBRARY_PATH<span style="color:#f92672">=</span>/Bioinfo/Pipeline/SoftWare/gdal-2.2.0/lib:/Bioinfo/Pipeline/SoftWare/geos-3.4.0/lib:/Bioinfo/Pipeline/SoftWare/proj-4.8.0/lib:$LD_LIBRARY_PATH
</code></pre></div><p>
<div class="post-img-view">
<a data-fancybox="gallery" href="https://cos.shenlab.cn/yuque/0/2023/png/126032/1686711600565-d48881bd-57bb-44ff-9521-a7351a42e0cd.png">
<img src="https://cos.shenlab.cn/yuque/0/2023/png/126032/1686711600565-d48881bd-57bb-44ff-9521-a7351a42e0cd.png" alt="image.png"  />
</a>
</div>

</p>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev"><a href="../../tech/try-singularity/">Singularity åˆæ¢ä¹‹å®‰è£…éƒ¨ç½²ä¸é¿å‘</a><br/>&larr;</span>
  <span class="nav-next"></span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
    url = '\/tech\/try-singularity\/';
    
  } else if (e.which == 39) {  
    
  }
  if (url) window.location = url;
});
</script>








<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script async src="https://blog.weiyan.cc/js/fix-toc.js"></script>
<script async src="https://blog.weiyan.cc/js/center-img.js"></script>
<script async src="https://blog.weiyan.cc/js/right-quote.js"></script>
<script async src="https://blog.weiyan.cc/js/fix-footnote.js"></script>
<script async src="https://blog.weiyan.cc/js/math-code.js"></script>
<script async src="https://blog.weiyan.cc/js/external-link.js"></script>
<script async src="https://blog.weiyan.cc/js/alt-title.js"></script>
<script async src="https://blog.weiyan.cc/js/header-link.js"></script>
<script async src="https://blog.weiyan.cc/js/dom-scripts.js"></script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.3.1/build/highlight.min.js"></script>
<script>hljs.highlightAll();</script>



  

  <div class="copyright">
      <script type="text/javascript" src="//rf.revolvermaps.com/0/0/6.js?i=5m6pzaeh5ar&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=0&amp;bv=0" async="async"></script>

  
      <br/><br/><a href="https://www.yuque.com/shenweiyan"><img src="https://img.shields.io/badge/%E8%AF%AD%E9%9B%80-%E4%BA%91%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%BA%93-blueviolet" alt="yuque"></a> <a href="https://www.bioitee.com"><img src="https://img.shields.io/badge/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7-BioIT%E7%88%B1%E5%A5%BD%E8%80%85-important" alt="wechat"></a> <a href="https://weibo.com/u/6020143196"><img src="https://img.shields.io/badge/%E5%BE%AE%E5%8D%9A-%E7%AB%A0%E9%B1%BC%E7%8C%AB%E5%85%88%E7%94%9F-blue" alt="weibo"></a> <a href="https://github.com/shenweiyan"><img src="https://img.shields.io/badge/GitHub-shenweiyan-green" alt="github"></a>
  

  
       
      <br/><br/>Â© Powered by <a href="https://github.com/shenweiyan/ICS-Hugo-Theme">ICS-Hugo-Theme</a> and  <a href="https://gohugo.io">Hugo</a> | <a href="https://www.bioitee.com/">Bio IT çˆ±å¥½è€…</a> 2018 - 2024 | <a href="http://beian.miit.gov.cn/">ç²¤ICPå¤‡16023717å·</a><br/>
  

  </div>
  

  </footer>
  </article>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
  </body>
</html>

