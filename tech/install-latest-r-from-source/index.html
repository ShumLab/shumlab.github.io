<!DOCTYPE html>
<html lang="zh-cn">
  <head>
    <meta charset="utf-8">
     
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.15.4/css/all.min.css"> 
    <link rel="stylesheet" href="../../fonts/academicons-1.8.6/css/academicons.min.css"/>
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css">
    <link rel="icon" type="image/png" sizes="32x32" href="../../img/logo.png"> 
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="baidu-site-verification" content="code-HxM5pCr1nD" />
    
    
    
    
    
    
    <title>Linux 下 R 源码安装指南 - 沈维燕 | BioIT 爱好者</title> 
    <meta property="og:title" content="Linux 下 R 源码安装指南 - 沈维燕 | BioIT 爱好者">
    

    
      
    

    

    
  
    <link rel="stylesheet" href="https://blog.weiyan.cc/css/style.css"/>
    <link rel="stylesheet" href="https://blog.weiyan.cc/css/fonts.css"/>
    

<link rel="stylesheet" href="https://blog.weiyan.cc/css/template-styles.css" />
<link rel="stylesheet" href="https://blog.weiyan.cc/css/custom.css" />
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.3.1/build/styles/github.min.css">


  </head>

  
  <body class="tech">
    
    
    <header class="intro-and-nav" role="banner">
    <div>
      <div class="intro">
        <a class="logo" href="../../" aria-label="沈维燕 | BioIT 爱好者 home page">
          <img src="https://blog.weiyan.cc/img/logo.png" alt="">
        </a>
        <p class="library-desc">
          
            Bio &amp; IT 爱好者
          
        </p>
      </div>
      <nav id="patterns-nav" class="patterns" role="navigation">
        <h2 class="vh">Main navigation</h2>
        <button id="menu-button" aria-expanded="false">
          
          目录
        </button>
        
        <ul id="patterns-list">
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../" >
              
              首页
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../about/" >
              
              关于
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../tech/" >
              
              技术
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../note/" >
              
              随笔
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../portfolio/" >
              
              作品
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../archive/" >
              
              归档
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../feedback/" >
              
              留言
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="../../tags/" >
              
              标签
            </a>
          </li>
          
          <li class="pattern">
          
          
	  
          
          
            <a href="https://www.yuque.com/shenweiyan" >
              
              语雀
            </a>
          </li>
          
          

<li class="pattern">&nbsp;&nbsp;</li>



<li class="pattern"><a href="https://github.com/shenweiyan/WebSiteSRC/edit/main/content/tech/2019-07-01-install-latest-r-from-source.md" target="_blank">编辑</a></li>


<li class="pattern"><a href="../../tech/index.xml" type="application/rss+xml" title="RSS feed">订阅</a></li>

<li class="pattern"><a href="../../license/" title="License">版权</a></li>


        </ul>
      </nav>
    </div>
    </header>

    <article class="main">
      <header class="title">
        

<h1>Linux 下 R 源码安装指南</h1>



<h4>沈维燕 &middot 
2019-07-01</h4> 


   
  


      </header>


  

  <blockquote>
<p>📢 本文章同步自作者的<a href="https://www.yuque.com/shenweiyan/">语雀知识库</a>，请点击<a href="https://www.yuque.com/shenweiyan/cookbook/install-latest-r-from-source">这里</a>阅读原文。</p>
</blockquote>
<p>如果你使用的 Linux 系统 GCC 版本太低, 又没有 root 权限 (即使有 root 权限又担心升级 GCC 带来的风险) ; 同时你又不想入坑 conda, 但是你又希望安装一个最新版本的 R, 那么恭喜你, 这篇普通用户在 Linux 下源码编译安装 R 的记录刚好满足了你想要的一切.。</p>
<blockquote>
<p><strong>📢 说明</strong></p>
<ol>
<li><strong>本文档以 R-3.6.0 为例, 但对于 R-3.6.x, R-4.0.x 的安装同样适用。</strong></li>
<li><strong>根据本教程，经过测试，以下版本均可以正常安装成功。</strong>
<ol>
<li><strong>R-4.0.3</strong></li>
<li><strong>R-4.1.2</strong></li>
<li><strong>R-4.3.0</strong></li>
</ol>
</li>
</ol>
</blockquote>
<p>本教程在以下的安装环境中，经过测试都可以正常操作：</p>
<table>
<thead>
<tr>
<th><strong>系统（版本）</strong></th>
<th><strong>GCC 版本</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td>Red Hat Enterprise Linux Server release 6.5 (Santiago), x86_64</td>
<td>gcc version 4.4.7 20120313 (Red Hat 4.4.7-4) (GCC)</td>
</tr>
<tr>
<td>CentOS Linux release 7.6.1810 (Core), x86_64</td>
<td>gcc version 4.8.5 20150623 (Red Hat 4.8.5-44) (GCC)</td>
</tr>
<tr>
<td>openEuler 20.03 (LTS)</td>
<td>gcc (GCC) 7.3.0</td>
</tr>
</tbody>
</table>
<h1 id="1-安装命令">1. 安装命令</h1>
<p>R 源码编译安装基本命令。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Rpy：--enable-R-shlib</span>
<span style="color:#75715e"># download list：https://mirrors.ustc.edu.cn/CRAN/src/base/</span>
$ wget https://mirrors.ustc.edu.cn/CRAN/src/base/R-3/R-3.6.0.tar.gz 
$ tar zxvf R-3.6.0.tar.gz
$ cd R-3.6.0
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/R-3.6.0  --enable-R-shlib --enable-BLAS-shlib  --with-blas   --with-lapack
</code></pre></div><p>关于 R 相关的动态库：</p>
<ul>
<li>R 编译的过程中，如果想要在其他语言中集成 R 就必须选择<code>--enable-R-shlib</code>选项，将 R 编译成 lib 模式，在此模式下，会生成 <code>path-to-R/lib/libR.so</code>库——将 R 编译成动态库(libR.so)，然后 R 的执行程序与之链接；
<ul>
<li>例如，如果不编译生成 <code>libR.so</code>，在安装 rpy2（Python 中的 R 语言接口模块） 时就无法正确编译。</li>
</ul>
</li>
<li>同时，确保同目录下 <code>libRblas.so</code>,<code>libRlapack.so</code> 两个链接库也被正确生成，这两个库默认会生成，如果没有，需要添加参数：<code>--enable-BLAS-shlib</code>,<code>--with-blas</code>,<code>--with-lapack</code>；</li>
</ul>
<h1 id="2-基础环境">2. 基础环境</h1>
<ul>
<li><strong>configure: error: No Fortran compiler found</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ubuntu/Debian</span>
apt install gfortran

<span style="color:#75715e"># RHEL/openEluer</span>
yum install gcc-gfortran
</code></pre></div><ul>
<li><strong>configure: error: C++ preprocessor &ldquo;/lib/cpp&rdquo; fails sanity check</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ubuntu/Debian</span>
apt install build-essential
apt install g++

<span style="color:#75715e"># RHEL/openEluer</span>
yum install glibc-headers
yum install gcc-c++
</code></pre></div><h1 id="3-各种库和依赖解决">3. 各种库和依赖解决</h1>
<p>R 源码编译安装的时候需要的各种依赖库比较多，如果你有 root 的权限，建议使用 <strong>yum/apt</strong> 等系统命令解决；如果没有 root 权限，可以手动一个个去解决。</p>
<h2 id="31-自动处理">3.1 自动处理</h2>
<p>针对 RHEL/Debian 一些常见的依赖，使用 yum/apt 自动解决的示例。</p>
<ul>
<li><strong>configure: error: &ndash;with-readline=yes (default) and headers/libs are not available</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ubuntu/Debian</span>
apt install install libreadline-dev

<span style="color:#75715e"># RHEL/openEluer</span>
yum install readline-devel 
</code></pre></div><ul>
<li><strong>configure: error: &ndash;with-x=yes (default) and X11 headers/libs are not available</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ubuntu/Debian</span>
apt install libx11-dev xorg-dev libcurl4-openssl-dev

<span style="color:#75715e"># RHEL/openEluer</span>
yum install xorg-x11-server-devel libX11-devel libXt-devel
</code></pre></div><ul>
<li><strong>configure: error: &ldquo;liblzma library and headers are required&rdquo;</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ubuntu/Debian</span>
apt install liblzma-dev

<span style="color:#75715e"># RHEL/openEluer</span>
yum install lzma-devel xz xz-devel
</code></pre></div><ul>
<li><strong>configure: error: PCRE2 library and headers are required, or use &ndash;with-pcre1 and PCRE &gt;= 8.32 with UTF-8 support</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ubuntu/Debian</span>
apt install libpcre2-dev

<span style="color:#75715e"># RHEL/openEluer </span>
yum install pcre pcre-devel			<span style="color:#75715e"># 安装 PCRE1</span>
yum install pcre2 pcre2-devel		<span style="color:#75715e"># 安装 PCRE2</span>
</code></pre></div><ul>
<li><strong>configure: error: libcurl &gt;= 7.28.0 library and headers are required with support for https</strong></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ubuntu/Debian</span>
apt install libcurl4-openssl-dev

<span style="color:#75715e"># RHEL/openEluer </span>
yum install libcurl-devel
</code></pre></div><h3 id="jpeg">JPEG</h3>
<p>R 安装过程中默认开启 <strong>&ndash;with-jpeglib</strong>（use jpeglib library (if available) [yes]），但是相关的依赖没有，依然可以正常安装（没有任何报错），但最后会提示：<strong>Capabilities skipped: JPEG！</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ubuntu/Debian</span>
yum install libjpeg-dev

<span style="color:#75715e"># RHEL/openEluer </span>
yum install libjpeg-devel
</code></pre></div><h3 id="tiff">TIFF</h3>
<p>R 安装过程中默认开启 <strong>&ndash;with-tifflib</strong>（use libtiff library (if available) [yes]），但是相关的依赖没有，依然可以正常安装（没有任何报错），但最后会提示：<strong>Capabilities skipped: TIFF！</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ubuntu/Debian</span>
yum install libtiff-dev

<span style="color:#75715e"># RHEL/openEluer </span>
yum install libtiff-devel
</code></pre></div><h3 id="cairo">cairo</h3>
<p>R 安装过程中默认开启 <strong>&ndash;with-cairo</strong>（use cairo (and pango) if available [yes]），但是相关的依赖没有，依然可以正常安装（没有任何报错），但最后会提示：<strong>Capabilities skipped:  cairo！</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ubuntu/Debian</span>
apt install libcairo2-dev libxt-dev

<span style="color:#75715e"># RHEL/openEluer </span>
yum install cairo-devel
</code></pre></div><h3 id="icu">ICU</h3>
<p>R 安装过程中默认开启 <strong>&ndash;with-ICU</strong>（use ICU library (if available) [yes]），如果不可用，最后会提示：<strong>Capabilities skipped: ICU！</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># Ubuntu/Debian</span>
apt install libicu-dev

<span style="color:#75715e"># RHEL/openEluer </span>
yum install libicu libicu-devel
</code></pre></div><h2 id="32-手动处理">3.2 手动处理</h2>
<p>以下是一些常见的依赖手动解决的示例，可以参考。</p>
<h3 id="zlib">zlib</h3>
<p>根据《<a href="https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Essential-programs-and-libraries">R Installation and Administration: A.1 Essential programs and libraries</a>》官方文档，zlib (version 1.2.5 or later)，至少需要 1.2.5 及以上版本。</p>
<blockquote>
<p>Installations of<code>zlib</code>(version 1.2.5 or later), <code>libbz2</code>(version 1.0.6 or later: called <strong>bzip2-libs/bzip2-devel</strong> or <strong>libbz2-1.0/libbz2-dev</strong> by some Linux distributions) and<code>liblzma</code>version 5.0.3 or later are required.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">报错：
checking <span style="color:#66d9ef">for</span> zlib.h... yes
checking <span style="color:#66d9ef">if</span> zlib version &gt;<span style="color:#f92672">=</span> 1.2.5... no
checking whether zlib support suffices... configure: error: zlib library and headers are required  
<span style="color:#75715e">## 缺少zlib或者zlib版本过低, 要求 zlib 版本 &gt;= 1.2.5 </span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># download list：http://www.zlib.net/fossils/</span>
$ wget http://www.zlib.net/fossils/zlib-1.2.6.tar.gz
$ tar xvf zlib-1.2.6.tar.gz
$ cd zlib-1.2.6
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/NewLibs/zlib-1.2.6
$ make <span style="color:#f92672">&amp;&amp;</span> make install
</code></pre></div><p>接着安装 R-3.6.0:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd ../R-3.6.0
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/R-3.6.0  --enable-R-shlib LDFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-L/Bioinfo/SoftWare/NewLibs/zlib-1.2.6/lib&#34;</span> CPPFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-I/Bioinfo/SoftWare/NewLibs/zlib-1.2.6/include&#34;</span>

    报错：
    checking <span style="color:#66d9ef">for</span> zlib.h... yes
    checking <span style="color:#66d9ef">if</span> zlib version &gt;<span style="color:#f92672">=</span> 1.2.5... yes
    checking whether zlib support suffices... yes
    checking mmap support <span style="color:#66d9ef">for</span> zlib... yes
    checking <span style="color:#66d9ef">for</span> BZ2_bzlibVersion in -lbz2... yes
    checking bzlib.h usability... yes
    checking bzlib.h presence... yes
    checking <span style="color:#66d9ef">for</span> bzlib.h... yes
    checking <span style="color:#66d9ef">if</span> bzip2 version &gt;<span style="color:#f92672">=</span> 1.0.6... no
    checking whether bzip2 support suffices... configure: error: bzip2 library and headers are required
    <span style="color:#75715e">## zlib 版本已经符合要求，bzip2 版本要求 &gt;= 1.0.6</span>
</code></pre></div><h3 id="bzip2-orlibbz2">bzip2 or libbz2</h3>
<p>根据《<a href="https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Essential-programs-and-libraries">R Installation and Administration: A.1 Essential programs and libraries</a>》官方文档, libbz2 (version 1.0.6 or later: called bzip2-libs/bzip2-devel or libbz2-1.0/libbz2-dev by some Linux distributions)，至少需要 1.0.6 及以上版本.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ wget http://www.bzip.org/1.0.6/bzip2-1.0.6.tar.gz
$ tar zvxf bzip2-1.0.6.tar.gz
$ cd bzip2-1.0.6
$ make -f Makefile-libbz2_so
$ make clean
$ make
$ make install PREFIX<span style="color:#f92672">=</span>/Bioinfo/SoftWare/NewLibs/bzip2-1.0.6
</code></pre></div><p>重新安装 R-3.6.0:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd ../R-3.6.0
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/R-3.6.0  --enable-R-shlib LDFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-L/Bioinfo/SoftWare/NewLibs/zlib-1.2.6/lib -L/Bioinfo/SoftWare/NewLibs/bzip2-1.0.6/lib&#34;</span> CPPFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-I/Bioinfo/SoftWare/NewLibs/zlib-1.2.6/include -I/Bioinfo/SoftWare/NewLibs/bzip2-1.0.6/include&#34;</span>

    报错：
    checking <span style="color:#66d9ef">if</span> bzip2 version &gt;<span style="color:#f92672">=</span> 1.0.6... yes
    checking whether bzip2 support suffices... yes
    checking <span style="color:#66d9ef">for</span> lzma_version_number in -llzma... yes
    checking lzma.h usability... yes
    checking lzma.h presence... yes
    checking <span style="color:#66d9ef">for</span> lzma.h... yes
    checking <span style="color:#66d9ef">if</span> lzma version &gt;<span style="color:#f92672">=</span> 5.0.3... yes
    checking <span style="color:#66d9ef">for</span> pcre_fullinfo in -lpcre... no
    checking whether PCRE support suffices... configure: error: pcre &gt;<span style="color:#f92672">=</span> 8.10 library and headers are required
    <span style="color:#75715e">## 要求 pcre &gt;= 8.10 (同时要求 pcre &lt; 10.0, 否则再次安装 R-3.6.0 时报错)</span>
    
    <span style="color:#75715e"># 安装 pcre-8.12，configure 编译 R-3.6.0 时报错:</span>
    checking <span style="color:#66d9ef">for</span> pcre/pcre.h... no
    checking <span style="color:#66d9ef">if</span> PCRE version &gt;<span style="color:#f92672">=</span> 8.10, &lt; 10.0 and has UTF-8 support... no
    checking whether PCRE support suffices... configure: error: pcre &gt;<span style="color:#f92672">=</span> 8.10 library and headers are required
    <span style="color:#75715e"># PCRE 安装需要 --enable-utf8，同时版本 &gt;= 8.10 且 &lt; 10.0</span>
</code></pre></div><h3 id="pcre">PCRE</h3>
<p>在《<a href="https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Essential-programs-and-libraries">R Installation and Administration: A.1 Essential programs and libraries</a>》官方文档中要求, PCRE 版本最好在 8.32 及以上.</p>
<blockquote>
<p>Either PCRE1 (version 8.32 or later, formerly known as just PCRE) or PCRE2 is required: PCRE2 is preferred and using PCRE1 requires configure option &ndash;with-pcre1. Only the 8-bit library and headers are needed if these are packaged separately. JIT support (optional) is desirable for the best performance. For PCRE2 &gt;= 10.30 (which is desirable as matching has been re-written not to use recursion and the Unicode tables were updated to version 10).</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># 源码安装 PCRE1</span>
$ wget https://ftp.pcre.org/pub/pcre/pcre-8.40.tar.gz --no-check-certificate
$ tar zvxf pcre-8.40.tar.gz
$ cd pcre-8.40
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/NewLibs/pcre-8.40 --enable-utf8
$ make -j3 <span style="color:#f92672">&amp;&amp;</span> make install

<span style="color:#75715e"># root 安装 PCRE1</span>
yum install pcre pcre-devel

<span style="color:#75715e"># 源码的方式安装 PCRE2，这里不介绍，跟源码安装 PCRE1 原理是一样的，自己去谷歌就好</span>
<span style="color:#75715e"># root 安装 PCRE2</span>
yum install pcre2 pcre2-devel
</code></pre></div><p>注意:</p>
<ol>
<li>R-3.4.2 要求 pcre 版本(&gt;= 8.20, &lt; 10.0)；</li>
<li>R-4.0.1 要求 PCRE &gt;= 8.32 with UTF-8 support；</li>
<li><strong>configure: error: PCRE2 library and headers are required, or use &ndash;with-pcre1 and PCRE &gt;= 8.32 with UTF-8 support</strong>。R-4.0 以上在 configure 时，需要增加一个 <code>--with-pcre1</code> 参数；或者安装 <strong>PCRE2！</strong></li>
</ol>
<p>重新安装 R-3.6.0:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ cd ../R-3.6.0
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/R-3.6.0  --enable-R-shlib LDFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-L/Bioinfo/SoftWare/NewLibs/zlib-1.2.6/lib -L/Bioinfo/SoftWare/NewLibs/bzip2-1.0.6/lib -L/Bioinfo/SoftWare/NewLibs/pcre-8.40/lib&#34;</span> CPPFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-I/Bioinfo/SoftWare/NewLibs/zlib-1.2.6/include -I/Bioinfo/SoftWare/NewLibs/bzip2-1.0.6/include -I/Bioinfo/SoftWare/NewLibs/pcre-8.40/include&#34;</span>

    报错：
    checking curl/curl.h usability... yes
    checking curl/curl.h presence... yes
    checking <span style="color:#66d9ef">for</span> curl/curl.h... yes
    checking <span style="color:#66d9ef">if</span> libcurl is version <span style="color:#ae81ff">7</span> and &gt;<span style="color:#f92672">=</span> 7.28.0... no
    configure: error: libcurl &gt;<span style="color:#f92672">=</span> 7.28.0 library and headers are required with support <span style="color:#66d9ef">for</span> https
    <span style="color:#75715e"># 需要安装 curl &gt;= 7.28.0</span>
</code></pre></div><h3 id="curl-orlibcurl">curl or libcurl</h3>
<p>在《R Installation and Administration: <a href="https://cran.r-project.org/doc/manuals/r-release/R-admin.html#Essential-programs-and-libraries">A.1 Essential programs and libraries</a>》要求, libcurl 大于或等于 7.22.0 版本。<strong>Library libcurl (version 7.22.0 or later) is required, with at least 7.28.0 being desirable.</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ wget https://curl.haxx.se/download/curl-7.64.1.tar.gz --no-check-certificate
$ tar zvxf curl-7.64.1.tar.gz
$ cd curl-7.64.1

<span style="color:#75715e">## 不指定证书</span>
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/NewLibs/curl-7.64.1

<span style="color:#75715e">## 指定证书(推荐)</span>
$ wget https://curl.haxx.se/ca/cacert.pem -O /Bioinfo/SoftWare/certs/ca-bundle.crt --no-check-certificate
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/NewLibs/curl-7.64.1 --with-ca-bundle<span style="color:#f92672">=</span>/Bioinfo/SoftWare/certs/ca-bundle.crt 

$ make
$ make install
</code></pre></div><p>如果你有管理员的权限，你也可以使用 root 的方法直接安装 libcurl：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># CentOS 7.6 自带的 libcurl 最新版本应该是 7.29.0-59.el7_9.1</span>
yum install libcurl libcurl-devel
</code></pre></div><p>注意:</p>
<ol>
<li>有些情况下，R 在链接一些在线数据库，或者下载某些特殊包时，可能导致 SSL certificate problem: unable to get local issuer certificate 异常，这种情况可以通过 <code>--with-ca-bundle</code> 指定证书来解决。</li>
<li>参考下面的内容。</li>
</ol>
<p><a href="https://www.yuque.com/shenweiyan/cookbook/r-ssl-certificate?view=doc_embed">R 语言关于 SSL 证书异常处理笔记</a></p>
<p>重新安装 R-3.6.0:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/R-3.6.0  --enable-R-shlib LDFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-L/Bioinfo/SoftWare/NewLibs/zlib-1.2.6/lib -L/Bioinfo/SoftWare/NewLibs/bzip2-1.0.6/lib -L/Bioinfo/SoftWare/NewLibs/pcre-8.40/lib -L/Bioinfo/SoftWare/NewLibs/curl-7.64.1/lib&#34;</span> CPPFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-I/Bioinfo/SoftWare/NewLibs/zlib-1.2.6/include -I/Bioinfo/SoftWare/NewLibs/bzip2-1.0.6/include -I/Bioinfo/SoftWare/NewLibs/pcre-8.40/include -I/Bioinfo/SoftWare/NewLibs/curl-7.64.1/include&#34;</span>

$ make 

    报错：
    /Bioinfo/SoftWare/NewLibs/bzip2-1.0.6/lib/libbz2.a: could not read symbols: Bad value
    collect2: ld returned <span style="color:#ae81ff">1</span> exit status
    make<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>: *** <span style="color:#f92672">[</span>libR.so<span style="color:#f92672">]</span> Error <span style="color:#ae81ff">1</span>
    make<span style="color:#f92672">[</span>3<span style="color:#f92672">]</span>: Leaving directory <span style="color:#e6db74">`</span>/home/shenweiyan/inst/R-3.6.0/src/main<span style="color:#e6db74">&#39;
</span><span style="color:#e6db74">    make[2]: *** [R] Error 2
</span><span style="color:#e6db74">    make[2]: Leaving directory `/home/shenweiyan/inst/R-3.6.0/src/main&#39;</span>
    make<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>: *** <span style="color:#f92672">[</span>R<span style="color:#f92672">]</span> Error <span style="color:#ae81ff">1</span>
    make<span style="color:#f92672">[</span>1<span style="color:#f92672">]</span>: Leaving directory <span style="color:#e6db74">`</span>/home/shenweiyan/inst/R-3.6.0/src<span style="color:#960050;background-color:#1e0010">&#39;</span>
    make: *** <span style="color:#f92672">[</span>R<span style="color:#f92672">]</span> Error <span style="color:#ae81ff">1</span>
    <span style="color:#75715e"># 需要使用64位元的方法重新编译 bzip2</span>
</code></pre></div><p>重装 bzip2-1.0.6, 如下所示, 首先修改 bzip2-1.0.6 的 Makefile 文件:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">CC<span style="color:#f92672">=</span>gcc <span style="color:#f92672">-</span>fPIC
AR<span style="color:#f92672">=</span>ar
RANLIB<span style="color:#f92672">=</span>ranlib
LDFLAGS<span style="color:#f92672">=</span>

BIGFILES<span style="color:#f92672">=-</span>D_FILE_OFFSET_BITS<span style="color:#f92672">=</span><span style="color:#ae81ff">64</span>
</code></pre></div><p>然后, 重新编译 bzip2-1.0.6:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ make clean
$ make
$ make install PREFIX<span style="color:#f92672">=</span>/Bioinfo/SoftWare/NewLibs/bzip2-1.0.6
</code></pre></div><h3 id="liblzma">liblzma</h3>
<p>在编译过程中发现: <strong>&ldquo;configure: error: &ldquo;liblzma library and headers are required&rdquo;</strong>, 需要安装 xz, 对应主页: <a href="https://tukaani.org/xz/">https://tukaani.org/xz/</a>, 安装如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ wget https://nchc.dl.sourceforge.net/project/lzmautils/xz-5.2.3.tar.gz
$ tar zvxf xz-5.2.3.tar.gz
$ cd xz-5.2.3/
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/NewLibs/xz-5.2.3
$ make -j3
$ make install
</code></pre></div><h3 id="libtiff">libtiff</h3>
<p>R shell 中使用 <strong>capabilities()</strong> 可以查看 R 已经编译支持的功能, 对于画图可以增加下面几个参数, 使 R 支持对应格式的图片保存, 与此同时要确保对应库已经安装.</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">--with-cairo            use cairo <span style="color:#f92672">(</span>and pango<span style="color:#f92672">)</span> <span style="color:#66d9ef">if</span> available <span style="color:#f92672">[</span>yes<span style="color:#f92672">]</span>
--with-libpng           use libpng library <span style="color:#f92672">(</span><span style="color:#66d9ef">if</span> available<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>yes<span style="color:#f92672">]</span>
--with-jpeglib          use jpeglib library <span style="color:#f92672">(</span><span style="color:#66d9ef">if</span> available<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>yes<span style="color:#f92672">]</span>
--with-libtiff          use libtiff library <span style="color:#f92672">(</span><span style="color:#66d9ef">if</span> available<span style="color:#f92672">)</span> <span style="color:#f92672">[</span>yes<span style="color:#f92672">]</span>
</code></pre></div><p>以 tiff 为例, 需要安装 libtiff 库:</p>
<blockquote>
<p>The bitmapped graphics devices jpeg(),  png() and tiff() need the appropriate headers and libraries installed: jpeg (version 6b or later, or libjpeg-turbo) or libpng (version 1.2.7 or later) and zlib or libtiff(versions 4.0.[5-10] have been tested) respectively.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ wget ftp://download.osgeo.org/libtiff/tiff-4.0.9.zip
$ unzip tiff-4.0.9.zip
$ cd tiff-4.0.9
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/NewLibs/tiff-4.0.9
$ make
$ make install
</code></pre></div><p>如果你有管理员权限，你也可以直接使用 root 直接安装 libtiff：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#75715e"># CentOS 7.6 自带的 libcurl 最新版本应该是 4.0.3-35.el7</span>
yum install libtiff libtiff-devel
</code></pre></div><p>然后重新编译 R-3.6.0:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/R-3.6.0 --enable-R-shlib --with-libtiff LDFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-L/Bioinfo/SoftWare/NewLibs/tiff-4.0.9/lib&#34;</span> CPPFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-I/Bioinfo/SoftWare/NewLibs/tiff-4.0.9/include&#34;</span>
</code></pre></div><p>如果 tiff 无法使用, 可以考虑在 ~/.bashrc 中添加 libtiff 库路径, 然后重新再编译 R .</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export LD_LIBRARY_PATH<span style="color:#f92672">=</span>/Bioinfo/SoftWare/NewLibs/tiff-4.0.9/lib:$LD_LIBRARY_PATH
export PKG_CONFIG_PATH<span style="color:#f92672">=</span>/Bioinfo/SoftWare/NewLibs/tiff-4.0.9/lib/pkgconfig:$PKG_CONFIG_PATH
</code></pre></div><h3 id="libjpeg-and-libpng16">libjpeg and libpng16</h3>
<p>R 安装完以后, 使用 plot 进行画图, 如果出现如下错误:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-r" data-lang="r"><span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">plot</span>(<span style="color:#ae81ff">1</span><span style="color:#f92672">:</span><span style="color:#ae81ff">0</span>)
Error <span style="color:#a6e22e">in </span>(<span style="color:#a6e22e">function </span>(display <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>, width, height, pointsize, gamma, bg,  <span style="color:#f92672">:</span>
  X11 module cannot be loaded
In addition<span style="color:#f92672">:</span> Warning message<span style="color:#f92672">:</span>
<span style="color:#a6e22e">In </span>(<span style="color:#a6e22e">function </span>(display <span style="color:#f92672">=</span> <span style="color:#e6db74">&#34;&#34;</span>, width, height, pointsize, gamma, bg,  <span style="color:#f92672">:</span>
  unable to load shared object <span style="color:#e6db74">&#39;/Bioinfo/SoftWare/R-3.6.0/lib64/R/modules//R_X11.so&#39;</span><span style="color:#f92672">:</span>
  libjpeg.so.9<span style="color:#f92672">:</span> cannot open shared object file<span style="color:#f92672">:</span> No such file or directory
<span style="color:#f92672">&gt;</span> <span style="color:#a6e22e">quit</span>()
Save workspace image<span style="color:#f92672">?</span> [y<span style="color:#f92672">/</span>n<span style="color:#f92672">/</span>c]<span style="color:#f92672">:</span> n
</code></pre></div><p>使用 <strong>ldd</strong> 命令如果看到 libjpeg.so.9、libpng16.so.16 not found，则可以考虑手动安装这两个包：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ /Bioinfo/SoftWare/R-3.6.0/bin/R CMD ldd /Bioinfo/SoftWare/R-3.6.0/lib64/R/modules//R_X11.so
        linux-vdso.so.1 <span style="color:#f92672">=</span>&gt;  <span style="color:#f92672">(</span>0x00007fff3c79b000<span style="color:#f92672">)</span>
        libtiff.so.5 <span style="color:#f92672">=</span>&gt; /Bioinfo/SoftWare/NewLibs/tiff-4.0.9/lib/libtiff.so.5 <span style="color:#f92672">(</span>0x00007f75369dc000<span style="color:#f92672">)</span>
        libjpeg.so.9 <span style="color:#f92672">=</span>&gt; not found
        libpng16.so.16 <span style="color:#f92672">=</span>&gt; not found
        libpangocairo-1.0.so.0 <span style="color:#f92672">=</span>&gt; /usr/lib64/libpangocairo-1.0.so.0 <span style="color:#f92672">(</span>0x00007f75367ba000<span style="color:#f92672">)</span>
        libpango-1.0.so.0 <span style="color:#f92672">=</span>&gt; /usr/lib64/libpango-1.0.so.0 <span style="color:#f92672">(</span>0x00007f753656e000<span style="color:#f92672">)</span>
        libgobject-2.0.so.0 <span style="color:#f92672">=</span>&gt; /lib64/libgobject-2.0.so.0 <span style="color:#f92672">(</span>0x00007f7536322000<span style="color:#f92672">)</span>
        ......
</code></pre></div><p>libjpeg.so.9, libpng16.so.16 安装步骤如下:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ wget http://www.ijg.org/files/jpegsrc.v9c.tar.gz
$ tar zvxf jpegsrc.v9c.tar.gz
$ cd jpeg-9c
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/NewLibs/jpeg-9c
$ make
$ make install

$ wget https://download.sourceforge.net/libpng/libpng-1.6.37.tar.gz
$ tar zvxf libpng-1.6.37.tar.gz
$ cd libpng-1.6.37
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/NewLibs/libpng-1.6.37
$ make
$ make install
</code></pre></div><ul>
<li><a href="http://libjpeg.sourceforge.net/">http://libjpeg.sourceforge.net/</a></li>
</ul>
<h1 id="4-完整编译安装命令">4. 完整编译安装命令</h1>
<p>如果使用了自定义安装的 gcc/c++ 进行编译, 需要在 configure 时候使用 CC/CXX 进行指定, 否则使用系统默认的 gcc/c++，由于 CentOS-6.5 默认的 gcc==4.4.7, 该版本的 gcc 会导致 R&gt;=3.5.0 编译出现各种错误，非 root 用户手动升级 gcc 可以参考：
<a href="https://www.yuque.com/shenweiyan/cookbook/linux-gcc-install?view=doc_embed">非 root 用户手动编译安装 GCC</a></p>
<p>最后，CentOS 下 R 源码安装的完整 configure 命令如下（同样适用于 Ubuntu/Debian）：</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#75715e"># 粘贴到命令行时，请把 \ 去掉，连成一行命令再回车执行</span>
$ ./configure --prefix<span style="color:#f92672">=</span>/Bioinfo/SoftWare/R-3.6.0 <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  CC<span style="color:#f92672">=</span>/Bioinfo/SoftWare/gcc-4.8.5/bin/gcc <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  CXX<span style="color:#f92672">=</span>/Bioinfo/SoftWare/gcc-4.8.5/bin/c++ <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --enable-R-shlib --with-libtiff --with-libpng --with-jpeglib <span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  --with-x --with-cairo --with-pcre1<span style="color:#ae81ff">\
</span><span style="color:#ae81ff"></span>  LDFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-L/Bioinfo/SoftWare/NewLibs/zlib-1.2.6/lib \
</span><span style="color:#e6db74">  -L/Bioinfo/SoftWare/NewLibs/bzip2-1.0.6/lib \ 
</span><span style="color:#e6db74">  -L/Bioinfo/SoftWare/NewLibs/pcre-8.40/lib \ 
</span><span style="color:#e6db74">  -L/Bioinfo/SoftWare/NewLibs/curl-7.64.1/lib \
</span><span style="color:#e6db74">  -L/Bioinfo/SoftWare/NewLibs/tiff-4.0.9/lib \
</span><span style="color:#e6db74">  -L/Bioinfo/SoftWare/NewLibs/jpeg-9c/lib \
</span><span style="color:#e6db74">  -L/Bioinfo/SoftWare/NewLibs/libpng-1.6.37/lib&#34;</span> <span style="color:#ae81ff">\ </span>
  CPPFLAGS<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;-I/Bioinfo/SoftWare/NewLibs/zlib-1.2.6/include \ 
</span><span style="color:#e6db74">  -I/Bioinfo/SoftWare/NewLibs/bzip2-1.0.6/include \ 
</span><span style="color:#e6db74">  -I/Bioinfo/SoftWare/NewLibs/pcre-8.40/include \
</span><span style="color:#e6db74">  -I/Bioinfo/SoftWare/NewLibs/curl-7.64.1/include \
</span><span style="color:#e6db74">  -I/Bioinfo/SoftWare/NewLibs/tiff-4.0.9/include \
</span><span style="color:#e6db74">  -I/Bioinfo/SoftWare/NewLibs/jpeg-9c/include \
</span><span style="color:#e6db74">  -I/Bioinfo/SoftWare/NewLibs/libpng-1.6.37/include&#34;</span>

<span style="color:#75715e"># configure 的所有配置信息，都会保存在 ./Makeconf 文件中</span>
checking build system type... x86_64-pc-linux-gnu
checking host system type... x86_64-pc-linux-gnu
loading site script <span style="color:#e6db74">&#39;./config.site&#39;</span>
......
config.status: executing libtool commands
config.status: executing stamp-h commands

R is now configured <span style="color:#66d9ef">for</span> x86_64-pc-linux-gnu

  Source directory:            .
  Installation directory:      /Bioinfo/SoftWare/R-3.6.0

  C compiler:                  gcc -std<span style="color:#f92672">=</span>gnu99  -g -O2
  Fortran fixed-form compiler: gfortran  -g -O2

  Default C++ compiler:        g++ -std<span style="color:#f92672">=</span>gnu++11  -g -O2
  C++14 compiler:
  C++17 compiler:
  C++20 compiler:
  Fortran free-form compiler:  gfortran  -g -O2
  Obj-C compiler:

  Interfaces supported:        X11, tcltk
  External libraries:          pcre2, readline, curl
  Additional capabilities:     PNG, JPEG, TIFF, NLS, cairo, ICU
  Options enabled:             shared R library, shared BLAS, R profiling

  Capabilities skipped:
  Options not enabled:         memory profiling

  Recommended packages:        yes

configure: WARNING: you cannot build info or HTML versions of the R manuals
configure: WARNING: neither inconsolata.sty nor zi4.sty found: PDF vignettes and package manuals will not be rendered optimally
</code></pre></div><p><strong>注意：</strong></p>
<ul>
<li><code>--with-x</code>，<code>--with-cairo</code> 是开启 X11 图形化的参数，应该增加一下。</li>
<li>R-4.0 以上需要增加一个 <code>--with-pcre1</code> 参数，或者直接使用 PCRE2。</li>
<li>最后关于 HTML 的 WARNING 不会影响 R 的安装和使用，可以忽略。</li>
</ul>
<p>最后，使用 make 和 make install 完成安装。</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ make 
$ make install
</code></pre></div><h1 id="5-设置环境变量">5. 设置环境变量</h1>
<p>最后, 把安装完成的 R 添加至环境变量:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">export R_HOME<span style="color:#f92672">=</span>path-to-R
export R_LIBS<span style="color:#f92672">=</span>$R_HOME/lib64/R/library
export LD_LIBRARY_PATH<span style="color:#f92672">=</span>$R_HOME/lib:$LD_LIBRARY_PATH
export PATH<span style="color:#f92672">=</span>$R_HOME/bin:$PATH
</code></pre></div><ul>
<li><strong>R_LIBS</strong> 的作用是 python 的 rpy2 调用安装的 R 包时，根据该变量寻找对应的包；</li>
<li><strong>LD_LIBRARY_PATH</strong> 则是相关动态依赖库需要查找的路径；</li>
<li>环境变量设置中比较容易漏掉的是 <strong>PATH</strong> 和 <strong>LD_LIBRARY_PATH</strong>，如果是用 root 安装，可能会没有问题，如果安装到个人目录下，不添加这两个变量的话，就无法正确寻找需要的动态链接库，如下：</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#960050;background-color:#1e0010">$</span> python
Python <span style="color:#ae81ff">2.7.14</span> (default, Mar  <span style="color:#ae81ff">9</span> <span style="color:#ae81ff">2018</span>, <span style="color:#ae81ff">08</span>:<span style="color:#ae81ff">39</span>:<span style="color:#ae81ff">17</span>)
[GCC <span style="color:#ae81ff">4.8.5</span> <span style="color:#ae81ff">20150623</span> (Red Hat <span style="color:#ae81ff">4.8.5</span><span style="color:#f92672">-</span><span style="color:#ae81ff">16</span>)] on linux2
Type <span style="color:#e6db74">&#34;help&#34;</span>, <span style="color:#e6db74">&#34;copyright&#34;</span>, <span style="color:#e6db74">&#34;credits&#34;</span> <span style="color:#f92672">or</span> <span style="color:#e6db74">&#34;license&#34;</span> <span style="color:#66d9ef">for</span> more information<span style="color:#f92672">.</span>
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">import</span> rpy2
<span style="color:#f92672">&gt;&gt;&gt;</span> <span style="color:#f92672">import</span> rpy2.robjects <span style="color:#66d9ef">as</span> robjects
Error: package <span style="color:#f92672">or</span> namespace load failed <span style="color:#66d9ef">for</span> <span style="color:#960050;background-color:#1e0010">‘</span>stats<span style="color:#960050;background-color:#1e0010">’</span> <span style="color:#f92672">in</span> dyn<span style="color:#f92672">.</span>load(file, DLLpath <span style="color:#f92672">=</span> DLLpath, <span style="color:#f92672">...</span>):
 unable to load shared object <span style="color:#e6db74">&#39;/Bioinfo/SoftWare/R-3.6.0/lib64/R/library/stats/libs/stats.so&#39;</span>:
  libRlapack<span style="color:#f92672">.</span>so: cannot open shared object file: No such file <span style="color:#f92672">or</span> directory
During startup <span style="color:#f92672">-</span> <span style="color:#a6e22e">Warning</span> message:
package <span style="color:#960050;background-color:#1e0010">‘</span>stats<span style="color:#960050;background-color:#1e0010">’</span> <span style="color:#f92672">in</span> options(<span style="color:#e6db74">&#34;defaultPackages&#34;</span>) was <span style="color:#f92672">not</span> found
<span style="color:#f92672">&gt;&gt;&gt;</span> robjects<span style="color:#f92672">.</span>r(<span style="color:#e6db74">&#39;library(splines)&#39;</span>)
Error: package <span style="color:#f92672">or</span> namespace load failed <span style="color:#66d9ef">for</span> <span style="color:#960050;background-color:#1e0010">‘</span>splines<span style="color:#960050;background-color:#1e0010">’</span> <span style="color:#f92672">in</span> dyn<span style="color:#f92672">.</span>load(file, DLLpath <span style="color:#f92672">=</span> DLLpath, <span style="color:#f92672">...</span>):
 unable to load shared object <span style="color:#e6db74">&#39;/Bioinfo/SoftWare/R-3.6.0/lib64/R/library/stats/libs/stats.so&#39;</span>:
  libRlapack<span style="color:#f92672">.</span>so: cannot open shared object file: No such file <span style="color:#f92672">or</span> directory
Traceback (most recent call last):
  File <span style="color:#e6db74">&#34;&lt;stdin&gt;&#34;</span>, line <span style="color:#ae81ff">1</span>, <span style="color:#f92672">in</span> <span style="color:#f92672">&lt;</span>module<span style="color:#f92672">&gt;</span>
  File <span style="color:#e6db74">&#34;/Bioinfo/SoftWare/Python-2.7.14/lib/python2.7/site-packages/rpy2/robjects/__init__.py&#34;</span>, line <span style="color:#ae81ff">269</span>, <span style="color:#f92672">in</span> __call__
    res <span style="color:#f92672">=</span> self<span style="color:#f92672">.</span>eval(p)
  File <span style="color:#e6db74">&#34;/Bioinfo/SoftWare/Python-2.7.14/lib/python2.7/site-packages/rpy2/robjects/functions.py&#34;</span>, line <span style="color:#ae81ff">170</span>, <span style="color:#f92672">in</span> __call__
    <span style="color:#66d9ef">return</span> super(SignatureTranslatedFunction, self)<span style="color:#f92672">.</span>__call__(<span style="color:#f92672">*</span>args, <span style="color:#f92672">**</span>kwargs)
  File <span style="color:#e6db74">&#34;/Bioinfo/SoftWare/Python-2.7.14/lib/python2.7/site-packages/rpy2/robjects/functions.py&#34;</span>, line <span style="color:#ae81ff">100</span>, <span style="color:#f92672">in</span> __call__
    res <span style="color:#f92672">=</span> super(Function, self)<span style="color:#f92672">.</span>__call__(<span style="color:#f92672">*</span>new_args, <span style="color:#f92672">**</span>new_kwargs)
rpy2<span style="color:#f92672">.</span>rinterface<span style="color:#f92672">.</span>RRuntimeError: Error: package <span style="color:#f92672">or</span> namespace load failed <span style="color:#66d9ef">for</span> <span style="color:#960050;background-color:#1e0010">‘</span>splines<span style="color:#960050;background-color:#1e0010">’</span> <span style="color:#f92672">in</span> dyn<span style="color:#f92672">.</span>load(file, DLLpath <span style="color:#f92672">=</span> DLLpath, <span style="color:#f92672">...</span>):
 unable to load shared object <span style="color:#e6db74">&#39;/Bioinfo/SoftWare/R-3.6.0/lib64/R/library/stats/libs/stats.so&#39;</span>:
  libRlapack<span style="color:#f92672">.</span>so: cannot open shared object file: No such file <span style="color:#f92672">or</span> directory
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ ldd /Bioinfo/SoftWare/R-3.6.0/lib64/R/library/stats/libs/stats.so
        linux-vdso.so.1 <span style="color:#f92672">=</span>&gt;  <span style="color:#f92672">(</span>0x00007fffd65ba000<span style="color:#f92672">)</span>
        libRlapack.so <span style="color:#f92672">=</span>&gt; not found
        libRblas.so <span style="color:#f92672">=</span>&gt; not found
        libgfortran.so.3 <span style="color:#f92672">=</span>&gt; /lib64/libgfortran.so.3 <span style="color:#f92672">(</span>0x00007fed38cbb000<span style="color:#f92672">)</span>
        libm.so.6 <span style="color:#f92672">=</span>&gt; /lib64/libm.so.6 <span style="color:#f92672">(</span>0x00007fed389b9000<span style="color:#f92672">)</span>
        libquadmath.so.0 <span style="color:#f92672">=</span>&gt; /lib64/libquadmath.so.0 <span style="color:#f92672">(</span>0x00007fed3877c000<span style="color:#f92672">)</span>
        libR.so <span style="color:#f92672">=</span>&gt; not found
        libgomp.so.1 <span style="color:#f92672">=</span>&gt; /lib64/libgomp.so.1 <span style="color:#f92672">(</span>0x00007fed38556000<span style="color:#f92672">)</span>
        libpthread.so.0 <span style="color:#f92672">=</span>&gt; /lib64/libpthread.so.0 <span style="color:#f92672">(</span>0x00007fed38339000<span style="color:#f92672">)</span>
        libc.so.6 <span style="color:#f92672">=</span>&gt; /lib64/libc.so.6 <span style="color:#f92672">(</span>0x00007fed37f76000<span style="color:#f92672">)</span>
        libgcc_s.so.1 <span style="color:#f92672">=</span>&gt; /lib64/libgcc_s.so.1 <span style="color:#f92672">(</span>0x00007fed37d60000<span style="color:#f92672">)</span>
        /lib64/ld-linux-x86-64.so.2 <span style="color:#f92672">(</span>0x00005561aa2c3000<span style="color:#f92672">)</span>
</code></pre></div><p>解决方法:</p>
<div class="highlight"><pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">$ export LD_LIBRARY_PATH<span style="color:#f92672">=</span><span style="color:#e6db74">&#34;/Bioinfo/SoftWare/R-3.6.0/lib64/R/lib:</span>$LD_LIBRARY_PATH<span style="color:#e6db74">&#34;</span>

$ ldd /Bioinfo/SoftWare/R-3.5.0/lib64/R/library/stats/libs/stats.so
        linux-vdso.so.1 <span style="color:#f92672">=</span>&gt;  <span style="color:#f92672">(</span>0x00007ffd0f3af000<span style="color:#f92672">)</span>
        libRlapack.so <span style="color:#f92672">=</span>&gt; /Bioinfo/SoftWare/R-3.6.0/lib64/R/lib/libRlapack.so <span style="color:#f92672">(</span>0x00007f6509c47000<span style="color:#f92672">)</span>
        libRblas.so <span style="color:#f92672">=</span>&gt; /Bioinfo/SoftWare/R-3.6.0/lib64/R/lib/libRblas.so <span style="color:#f92672">(</span>0x00007f6509a19000<span style="color:#f92672">)</span>
        libgfortran.so.3 <span style="color:#f92672">=</span>&gt; /lib64/libgfortran.so.3 <span style="color:#f92672">(</span>0x00007f65096ee000<span style="color:#f92672">)</span>
        libm.so.6 <span style="color:#f92672">=</span>&gt; /lib64/libm.so.6 <span style="color:#f92672">(</span>0x00007f65093ec000<span style="color:#f92672">)</span>
        libquadmath.so.0 <span style="color:#f92672">=</span>&gt; /lib64/libquadmath.so.0 <span style="color:#f92672">(</span>0x00007f65091af000<span style="color:#f92672">)</span>
        libR.so <span style="color:#f92672">=</span>&gt; /Bioinfo/SoftWare/R-3.6.0/lib64/R/lib/libR.so <span style="color:#f92672">(</span>0x00007f6508b81000<span style="color:#f92672">)</span>
        libgomp.so.1 <span style="color:#f92672">=</span>&gt; /lib64/libgomp.so.1 <span style="color:#f92672">(</span>0x00007f650895b000<span style="color:#f92672">)</span>
        libpthread.so.0 <span style="color:#f92672">=</span>&gt; /lib64/libpthread.so.0 <span style="color:#f92672">(</span>0x00007f650873e000<span style="color:#f92672">)</span>
        libc.so.6 <span style="color:#f92672">=</span>&gt; /lib64/libc.so.6 <span style="color:#f92672">(</span>0x00007f650837b000<span style="color:#f92672">)</span>
        libgcc_s.so.1 <span style="color:#f92672">=</span>&gt; /lib64/libgcc_s.so.1 <span style="color:#f92672">(</span>0x00007f6508165000<span style="color:#f92672">)</span>
        /lib64/ld-linux-x86-64.so.2 <span style="color:#f92672">(</span>0x000055583c2da000<span style="color:#f92672">)</span>
        libreadline.so.6 <span style="color:#f92672">=</span>&gt; /lib64/libreadline.so.6 <span style="color:#f92672">(</span>0x00007f6507f1e000<span style="color:#f92672">)</span>
        libpcre.so.1 <span style="color:#f92672">=</span>&gt; /lib64/libpcre.so.1 <span style="color:#f92672">(</span>0x00007f6507cbc000<span style="color:#f92672">)</span>
        liblzma.so.5 <span style="color:#f92672">=</span>&gt; /lib64/liblzma.so.5 <span style="color:#f92672">(</span>0x00007f6507a96000<span style="color:#f92672">)</span>
        libbz2.so.1 <span style="color:#f92672">=</span>&gt; /lib64/libbz2.so.1 <span style="color:#f92672">(</span>0x00007f6507885000<span style="color:#f92672">)</span>
        libz.so.1 <span style="color:#f92672">=</span>&gt; /lib64/libz.so.1 <span style="color:#f92672">(</span>0x00007f650766f000<span style="color:#f92672">)</span>
        librt.so.1 <span style="color:#f92672">=</span>&gt; /lib64/librt.so.1 <span style="color:#f92672">(</span>0x00007f6507467000<span style="color:#f92672">)</span>
        libdl.so.2 <span style="color:#f92672">=</span>&gt; /lib64/libdl.so.2 <span style="color:#f92672">(</span>0x00007f6507262000<span style="color:#f92672">)</span>
        libtinfo.so.5 <span style="color:#f92672">=</span>&gt; /lib64/libtinfo.so.5 <span style="color:#f92672">(</span>0x00007f6507038000<span style="color:#f92672">)</span>
</code></pre></div><p>以上就是普通用户源码编译安装最新版本 R 的全部内容, <strong>总的一句话就是缺什么安装什么, 从最基本的 gcc 编译器开始到 R 所需要的各种依赖库</strong>，直至最终安装完成.。</p>
<h1 id="6-参考资料">6. 参考资料</h1>
<ul>
<li>R 官方文档，《<a href="https://cran.r-project.org/doc/manuals/r-release/R-admin.html">R Installation and Administration</a>》，CRAN</li>
<li>沈维燕，《<a href="https://www.yuque.com/shenweiyan/cookbook/linux-gcc-install">非 root 用户手动编译安装 GCC</a>》，语雀</li>
<li>沈维燕，《<a href="https://www.yuque.com/shenweiyan/cookbook/r-ssl-certificate">R 语言关于 SSL 证书异常处理笔记</a>》，语雀</li>
</ul>


  <footer>
  
<nav class="post-nav">
  <span class="nav-prev"></span>
  <span class="nav-next"><a href="../../tech/linux-lvm/">Linux 磁盘管理之 LVM 原理与操作</a><br/>&rarr;</span>
</nav>
<script type="text/javascript">
document.addEventListener('keyup', function(e) {
  if (e.target.nodeName.toUpperCase() != 'BODY') return;
  var url = false;
  if (e.which == 37) {  
    
  } else if (e.which == 39) {  
    
    url = '\/tech\/linux-lvm\/';
    
  }
  if (url) window.location = url;
});
</script>








<script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.min.js"></script>
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>

<script async src="https://blog.weiyan.cc/js/fix-toc.js"></script>
<script async src="https://blog.weiyan.cc/js/center-img.js"></script>
<script async src="https://blog.weiyan.cc/js/right-quote.js"></script>
<script async src="https://blog.weiyan.cc/js/fix-footnote.js"></script>
<script async src="https://blog.weiyan.cc/js/math-code.js"></script>
<script async src="https://blog.weiyan.cc/js/external-link.js"></script>
<script async src="https://blog.weiyan.cc/js/alt-title.js"></script>
<script async src="https://blog.weiyan.cc/js/header-link.js"></script>
<script async src="https://blog.weiyan.cc/js/dom-scripts.js"></script>
<script type="text/javascript" async src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.7/MathJax.js?config=TeX-MML-AM_CHTML"></script>
<script src="https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.3.1/build/highlight.min.js"></script>
<script>hljs.highlightAll();</script>



  

  <div class="copyright">
      <script type="text/javascript" src="//rf.revolvermaps.com/0/0/6.js?i=5m6pzaeh5ar&amp;m=0&amp;c=ff0000&amp;cr1=ffffff&amp;f=arial&amp;l=0&amp;bv=0" async="async"></script>

  
      <br/><br/><a href="https://www.yuque.com/shenweiyan"><img src="https://img.shields.io/badge/%E8%AF%AD%E9%9B%80-%E4%BA%91%E7%AB%AF%E7%9F%A5%E8%AF%86%E5%BA%93-blueviolet" alt="yuque"></a> <a href="https://www.bioitee.com"><img src="https://img.shields.io/badge/%E5%BE%AE%E4%BF%A1%E5%85%AC%E4%BC%97%E5%8F%B7-BioIT%E7%88%B1%E5%A5%BD%E8%80%85-important" alt="wechat"></a> <a href="https://weibo.com/u/6020143196"><img src="https://img.shields.io/badge/%E5%BE%AE%E5%8D%9A-%E7%AB%A0%E9%B1%BC%E7%8C%AB%E5%85%88%E7%94%9F-blue" alt="weibo"></a> <a href="https://github.com/shenweiyan"><img src="https://img.shields.io/badge/GitHub-shenweiyan-green" alt="github"></a>
  

  
       
      <br/><br/>© Powered by <a href="https://github.com/shenweiyan/ICS-Hugo-Theme">ICS-Hugo-Theme</a> and  <a href="https://gohugo.io">Hugo</a> | <a href="https://www.bioitee.com/">Bio IT 爱好者</a> 2018 - 2024 | <a href="http://beian.miit.gov.cn/">粤ICP备16023717号</a><br/>
  

  </div>
  

  </footer>
  </article>
  
  <script src="https://cdn.jsdelivr.net/npm/jquery@3.4.1/dist/jquery.min.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/fancyapps/fancybox@3.5.7/dist/jquery.fancybox.min.js"></script>
  </body>
</html>

